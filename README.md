# âœï¸ Toy Project : ê¸€ë§ˆë””

### â–ªï¸ í”„ë¡œì íŠ¸ ì†Œê°œ

> 'ê¸€ë§ˆë””'ëŠ” ì±…ì´ë‚˜ ë…¸ë˜ì—ì„œ ë°œê²¬í•œ ì¸ìƒì ì¸ ë¬¸êµ¬ë‚˜ ê°€ì‚¬ë¥¼ ê¸°ë¡í•˜ê³ , ì„œë¡œ ê³µìœ í•˜ëŠ” ì›¹ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. <br><br>
> ì±…ì„ ì½ê±°ë‚˜ ë…¸ë˜ë¥¼ ë“£ë‹¤ê°€ ê°ëª…ê¹Šì€ êµ¬ì ˆì„ ë°œê²¬í–ˆë‚˜ìš”? <br>
> ë§ˆìŒì—ë§Œ ë‹´ì•„ë‘ë‹¤ ìŠí˜€ì§ˆê¹Œ ì•„ì‰¬ìš´ êµ¬ì ˆì„ ê¸°ë¡í•´ë³´ì„¸ìš” <br>
> ê·¸ë¦¬ê³  ì£¼ë³€ì˜ ì†Œì¤‘í•œ ì‚¬ëŒë“¤ì—ê²Œ ì˜ˆìœ ì‚¬ì§„ìœ¼ë¡œë„ ê³µìœ í•´ë³´ì„¸ìš” <br>

### â–ªï¸ í”„ë¡œì íŠ¸ ê¸°ê°„

- 2023.04.05 ~ 2023. 05. 09

### â–ªï¸ í”„ë¡œì íŠ¸ ê°œìš”

- [ê¸€ë§ˆë”” ì›¹ì‚¬ì´íŠ¸ ë°”ë¡œê°€ê¸°](https://geulmadi.netlify.app/)
- [í”„ë¡œì íŠ¸ íšŒê³  (ë¯¸ì™„)](ë§í¬)

### â–ªï¸ ê¸°ìˆ  ìŠ¤íƒ

- JavaScript (ES6) / SASS (SCSS) / HTML
- Firebase (Realtime Database, Authentication)
- MVC Architecture

### â–ªï¸ package.json

```json
{
  "name": "geulmadi",
  "version": "1.0.0",
  "description": "",
  "scripts": {
    "start": "parcel index.html",
    "build": "parcel build index.html"
  },
  "keywords": [],
  "author": "Minsu Han",
  "license": "ISC",
  "devDependencies": {
    "@parcel/transformer-sass": "^2.8.3",
    "dotenv": "^16.0.3",
    "downloadjs": "^1.4.7",
    "firebase": "^9.19.1",
    "html-to-image": "^1.11.11",
    "localtunnel": "^2.0.2",
    "parcel-bundler": "^1.12.5",
    "parcel-plugin-static-files-copy": "^2.6.0",
    "regenerator-runtime": "^0.13.11",
    "sass": "^1.61.0",
    "sweetalert2": "^11.7.3"
  },
  "staticFiles": {
    "staticPath": "static"
  }
}
```

### â–ªï¸ ê°œë°œ í™˜ê²½

- ê³„íš ë° ì¼ì •ê´€ë¦¬ â¡ï¸ [Notion](https://accurate-bank-c77.notion.site/cfce9924c3e44aa8ad5935acf35c21ea)

  ![image](https://github.com/minsuhan1/JavaScript_course_2022/assets/50696567/e66b75bf-c697-4c25-893f-5a25651f613a)

- IDE â¡ï¸ Visual Studio Code

- ë²„ì „ê´€ë¦¬ â¡ï¸ Git + [GitHub](https://github.com/minsuhan1/geulmadi)

- ì™€ì´ì–´í”„ë ˆì„ ì œì‘ â¡ï¸ [Figma](https://www.figma.com/file/6yNejRcsjim7nQ3jw2myPt/%EA%B8%80%EB%A7%88%EB%94%94?type=design&node-id=0-1&t=UzksdTBY8k87O6Wx-0)

### â–ªï¸ ë””ë ‰í„°ë¦¬ êµ¬ì¡°

```bash
ğŸ“¦
â”œâ”€Â .gitignore
â”œâ”€Â README.md
â”œâ”€Â index.html
â”œâ”€Â package-lock.json
â”œâ”€Â package.json
â”œâ”€Â .env
â”œâ”€Â src
â”‚Â Â â”œâ”€Â js
â”‚Â Â â”‚Â Â â”œâ”€Â auth.js
â”‚Â Â â”‚Â Â â”œâ”€Â config.js
â”‚Â Â â”‚Â Â â”œâ”€Â controllers
â”‚Â Â â”‚Â Â â”‚Â Â â”œâ”€Â loginController.js
â”‚Â Â â”‚Â Â â”‚Â Â â””â”€Â postController.js
â”‚Â Â â”‚Â Â â”œâ”€Â helpers.js
â”‚Â Â â”‚Â Â â”œâ”€Â model
â”‚Â Â â”‚Â Â â”‚Â Â â””â”€Â model.js
â”‚Â Â â”‚Â Â â””â”€Â views
â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â .prettierrc
â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â View.js
â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â cardView.js
â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â loginView.js
â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â popularView.js
â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â postListView.js
â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â registerView.js
â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â resetPasswordView.js
â”‚Â Â â”‚Â Â Â Â Â â”œâ”€Â searchView.js
â”‚Â Â â”‚Â Â Â Â Â â””â”€Â uploadView.js
â”‚Â Â â””â”€Â sass
â”‚Â Â Â Â Â â”œâ”€Â _base.scss
â”‚Â Â Â Â Â â”œâ”€Â _card.scss
â”‚Â Â Â Â Â â”œâ”€Â _collection.scss
â”‚Â Â Â Â Â â”œâ”€Â _components.scss
â”‚Â Â Â Â Â â”œâ”€Â _forms.scss
â”‚Â Â Â Â Â â”œâ”€Â _header.scss
â”‚Â Â Â Â Â â”œâ”€Â _helpers.scss
â”‚Â Â Â Â Â â”œâ”€Â _hero.scss
â”‚Â Â Â Â Â â”œâ”€Â _mixins.scss
â”‚Â Â Â Â Â â””â”€Â main.scss
â””â”€Â static
Â Â Â â””â”€Â assets
Â Â Â Â Â Â â””â”€Â img
Â Â Â Â Â Â Â Â Â â”œâ”€Â empty-box.png
Â Â Â Â Â Â Â Â Â â”œâ”€Â logo.png
Â Â Â Â Â Â Â Â Â â””â”€Â ogImage.png
```

Â©generated by [Project Tree Generator](https://woochanleee.github.io/project-tree-generator)

<br />

### â–ªï¸ êµ¬í˜„í•œ ê¸°ëŠ¥

- `Firebase Authentication`ì„ í™œìš©í•œ íšŒì›ê°€ì…/ë¡œê·¸ì¸ ì¸ì¦
- `.env` íŒŒì¼ì„ í†µí•œ API KEY ë³´ì•ˆ ê´€ë¦¬ (`dotenv`)
- `Firebase Realtime Database`ë¥¼ í™œìš©í•œ ê¸€ë§ˆë”” ì¶”ê°€/ë¡œë“œ/ìˆ˜ì •/ì‚­ì œ ë° ì¢‹ì•„ìš” ê¸°ëŠ¥
- `hashchange` ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ í™œìš©í•œ ì¹´í…Œê³ ë¦¬(ìµœì‹ /ì¸ê¸°/ë‚´ ê¸€ë§ˆë””/ì¢‹ì•„ìš”) ê¸°ëŠ¥
- ìƒìœ„ 20ê°œ ì¸ê¸° íƒœê·¸, ì¸ê¸° ì‘ê°€/ê°€ìˆ˜ í‘œì‹œ ê¸°ëŠ¥
- í‚¤ì›Œë“œ/ë¶„ë¥˜ ê¸°ë°˜ ê²€ìƒ‰ ê¸°ëŠ¥
- `html-to-image`, `downloadjs` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•œ ê¸€ë§ˆë”” ì¹´ë“œ PNG ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥
- `Web Share API` ë° `blob`ì„ í™œìš©í•œ ê¸€ë§ˆë”” ì¹´ë“œ ì™¸ë¶€ ê³µìœ  ê¸°ëŠ¥
- ëª¨ë°”ì¼ ë°˜ì‘í˜• UI êµ¬í˜„ (`mediaQuery`, `@mixin`, `IntersectionObserver API`)

<br />

### â–ªï¸ êµ¬í˜„ ê¸°ëŠ¥ ìš”ì•½

#### â‘  Firebase Authentication ê¸°ë°˜ ê³„ì •ìƒì„±/ë¡œê·¸ì¸

> êµ¬í˜„ ê³¼ì • íšŒê³  â¡ï¸
> [[ê¸€ë§ˆë”” í”„ë¡œì íŠ¸] Firebase ì¸ì¦ ê¸°ëŠ¥ ì ìš© íšŒê³  (feat. MVC ëª¨ë¸)](https://velog.io/@minsuhan1/FE-%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%EC%97%90-Firebase-%EC%9D%B8%EC%A6%9D-%EA%B8%B0%EB%8A%A5-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0-feat.-MVC-%EB%AA%A8%EB%8D%B8)

![Animation](https://github.com/minsuhan1/JavaScript_course_2022/assets/50696567/19042c53-8a2d-4308-99f7-84ff5fa02b0a)

- `Firebase Authentication`ì„ ì ìš©í•˜ì—¬ ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ ê¸°ë°˜ ê³„ì •ìƒì„±/ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ, Google ì†Œì…œ ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. DEMO ë°°í¬ ì „ì—ëŠ” API KEY ë³´ì•ˆì„ ìœ„í•´ í™˜ê²½ë³€ìˆ˜ë¥¼ íŒŒì¼ë¡œ ê´€ë¦¬í•˜ê²Œ í•´ ì£¼ëŠ” `dotenv` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ .env íŒŒì¼ ë‚´ì— API KEY ê°’ì„ ì‘ì„±í•˜ê³ , ì‹¤ì œ Firebase ê°ì²´ë¥¼ Initializeí•˜ëŠ” `auth.js`ì—ì„œ ë¶ˆëŸ¬ì™€ì„œ ì‚¬ìš©í•˜ë„ë¡ í–ˆìŠµë‹ˆë‹¤.

```js
import dotenv from "dotenv";

import { initializeApp } from "firebase/app";
import { getAuth } from "firebase/auth";

dotenv.config();

class Auth {
  // Your web app's Firebase configuration
  #firebaseConfig = {
    apiKey: process.env.FIREBASE_API_KEY,
    authDomain: process.env.FIREBASE_AUTH_DOMAIN,
    databaseURL: process.env.FIREBASE_DATABASE_URL,
    projectId: process.env.FIREBASE_PROJECT_ID,
    storageBucket: process.env.FIREBASE_STORAGE_BUCKET,
    messagingSenderId: process.env.FIREBASE_MESSAGING_SENDER_ID,
    appId: process.env.FIREBASE_APP_ID,
  };

  // Initialize Firebase
  #firebase_app = initializeApp(this.#firebaseConfig);
  #auth = getAuth(this.#firebase_app);
}

export default new Auth();
```

- Firebase ì¸ì¦ì„ êµ¬í˜„í•˜ëŠ” ë° í•„ìš”í•œ ì½”ë“œë¥¼ ì•„ë˜ì™€ ê°™ì´ MVC ëª¨ë¸ë¡œ ë¶„ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.

  - Model : auth.js â¡ï¸ ì¸ì¦ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” API ì œê³µ
  - View : loginView.js, registerView.js â¡ï¸ ìœ ì €ì˜ í™”ë©´ë‹¨ì—ì„œì˜ ì¸ì¦ ìš”ì²­ì„ ê°ì§€í•˜ëŠ” í•¸ë“¤ëŸ¬ ì œê³µ
  - Controller : loginController.js â¡ï¸ ì¸ì¦ ì§„í–‰ê³¼ì • ì´ê´„

```js
> auth.js

async signInEmail(email, password) {
  try {
    // ret data: (userCredential);
    const data = await signInWithEmailAndPassword(
      this.#auth,
      email,
      password
    );
    return data;
  } catch (err) {
    throw err;
  }
}
```

```js
> loginView.js

addHandlerSignIn(handler) {
  this.#form.addEventListener('submit', function (e) {
    // FormData ê°ì²´ëŠ” formì˜ input ìš”ì†Œë“¤ì„ ['name', 'value'] í˜•íƒœë¡œ ë§¤í•‘í•´ ì¤€ë‹¤.
    const formData = [...new FormData(this)].map(data => data[1]);

    e.preventDefault();
    handler(formData);
  });
}
```

```js
> loginController.js

import auth from "../auth.js";
import loginView from "../views/loginView.js";

const controlSignIn = async function (formData) {
  try {
    // Firebase ë¡œê·¸ì¸ ì¸ì¦ ëŒ€ê¸°
    // formData[0]: Email, formData[1]: Password
    const data = await auth.signInEmail(formData[0], formData[1]);
    // ì¸ì¦ ì™„ë£Œ ë©”ì‹œì§€ í‘œì‹œ
    loginView.renderSuccessMessage("ë¡œê·¸ì¸ ì„±ê³µ");
  } catch (err) {
    // ì˜¤ë¥˜ì½”ë“œì— ë”°ë¥¸ ë©”ì‹œì§€ í‘œì‹œ
    loginView.renderError(convertErrorCodeToMessage(err.code));
  }
};

const convertErrorCodeToMessage = function (errCode) {
  switch (errCode) {
    case "auth/wrong-password":
      return "ì´ë©”ì¼ í˜¹ì€ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.";
    case "auth/user-not-found":
      return "ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê³„ì •ì…ë‹ˆë‹¤.";
    case "auth/email-already-in-use":
      return "ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤.";
    // ... ê·¸ ì™¸ ë‹¤ì–‘í•œ ì˜¤ë¥˜ì½”ë“œ ì²˜ë¦¬ ì½”ë“œ
    default:
      return "ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”";
  }
};

loginView.addHandlerSignIn(controlSignIn);
```

- ìœ„ ì½”ë“œëŠ” ìœ ì €ì˜ ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­ì„ ê°ì§€í–ˆì„ ë•Œ Controllerê°€ Viewë¡œë¶€í„° ìœ ì €ê°€ ì œì¶œí•œ ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ ê°’ì„ ë°›ì•„ì„œ Authê°€ ì œê³µí•˜ëŠ” `signInEmail` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ì¸ì¦ì„ ìš”ì²­í•˜ê³  ê²°ê³¼ë¥¼ ìˆ˜ì‹ í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.

- ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ ì—¬ëŸ¬ ì¸ì¦ ê¸°ëŠ¥ë“¤ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ Authì¸¡ì—ì„œ ì œê³µí•˜ëŠ” APIëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

  - signUpEmail â¡ï¸ ì´ë©”ì¼/íŒ¨ìŠ¤ì›Œë“œ ê¸°ë°˜ì˜ Firebase ê³„ì •ì„ ìƒì„±í•©ë‹ˆë‹¤. ë‚´ë¶€ì ìœ¼ë¡œ Firebase Authì—ì„œ ì œê³µí•˜ëŠ” `createUserWithEmailAndPassword` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

  - signInEmail â¡ï¸ ì´ë©”ì¼/íŒ¨ìŠ¤ì›Œë“œ ê¸°ë°˜ì˜ Firebase ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤. ë‚´ë¶€ì ìœ¼ë¡œ Firebase Authì—ì„œ ì œê³µí•˜ëŠ” `signInWithEmailAndPassword` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

  - signOutUser â¡ï¸ í˜„ì¬ ë¡œê·¸ì¸ ìƒíƒœì˜ Firebase ê³„ì •ì—ì„œ ë¡œê·¸ì•„ì›ƒí•©ë‹ˆë‹¤. ë‚´ë¶€ì ìœ¼ë¡œ Firebase Authì—ì„œ ì œê³µí•˜ëŠ” `signOut` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

  - resetPassword â¡ï¸ ê³„ì •ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¬ì„¤ì •í•˜ëŠ” ë§í¬ë¥¼ ì´ë©”ì¼ë¡œ ì „ì†¡í•©ë‹ˆë‹¤. ë‚´ë¶€ì ìœ¼ë¡œ Firebase Authì—ì„œ ì œê³µí•˜ëŠ” `sendPasswordResetEmail` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

  - signInGoogle â¡ï¸ Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆëŠ” íŒì—…ì°½ì„ í‘œì‹œí•´ì¤ë‹ˆë‹¤. ë‚´ë¶€ì ìœ¼ë¡œ Firebase Authì˜ `GoogleAuthProvider` ê°ì²´ê°€ ì œê³µí•˜ëŠ” `signInWithPopup` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

- Firebase Authì—ì„œ ì œê³µí•˜ëŠ” `onAuthStateChanged` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒ ë“±ìœ¼ë¡œ ì¸í•œ í˜„ì¬ ì¸ì¦ ìƒíƒœ ë° ì •ë³´ ë³€ê²½ì´ ê°ì§€ë˜ì—ˆì„ ë•Œ Controllerì—ì„œ ìˆ˜í–‰í•  handler ë©”ì„œë“œë¥¼ ë“±ë¡í•˜ì˜€ìŠµë‹ˆë‹¤.

```js
> auth.js

onUserStateChange(handler) {
  this.#auth.onAuthStateChanged((user) => {
    handler(user);
  });
}
```

```js
> loginController.js

/**
 * @description ë¡œê·¸ì¸ ì •ë³´ ë³€ê²½ ê°ì§€ ì‹œ Auth ì •ë³´ ì´ˆê¸°í™”
 * @param { Object } userCredential ìœ ì € ì •ë³´ ê°ì²´
 */
const init = async function (user) {
  // ... Auth ì •ë³´ ì´ˆê¸°í™” ì½”ë“œ
};

auth.onUserStateChange(init);
```

<br />

#### â‘¡ ê¸€ë§ˆë”” CRUD ë° ì¢‹ì•„ìš” ê¸°ëŠ¥ (Realtime Database)

> êµ¬í˜„ ê³¼ì • íšŒê³  â¡ï¸
> [[ê¸€ë§ˆë”” í”„ë¡œì íŠ¸] Realtime Databaseë¥¼ í™œìš©í•œ ê¸€ë§ˆë”” CRUD ë° ì¢‹ì•„ìš” ê¸°ëŠ¥ êµ¬í˜„ íšŒê³ ](https://velog.io/@minsuhan1/title-zlx5x36r#%EC%8B%9C%EC%9E%91%ED%95%98%EB%A9%B0)

![Animation](https://github.com/minsuhan1/JavaScript_course_2022/assets/50696567/ad91b206-bb60-487c-b041-c4d81ff0f452)

- `Firebase Realtime DB`ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸€ë§ˆë””(`posts`)ì™€ ê° ìœ ì €ê°€ ì¢‹ì•„ìš” í‘œì‹œí•œ ê¸€ë§ˆë””(`likes`)ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•´, ì•„ë˜ì™€ ê°™ì€ ë°ì´í„° êµ¬ì¡°ë¥¼ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.

```js
posts: {
  id: {		// ê¸€ë§ˆë”” id (POST ìš”ì²­ìœ¼ë¡œ ê¸€ë§ˆë”” ì¶”ê°€ ì‹œ ìë™ìœ¼ë¡œ ìƒì„±ë¨)
    type,	// ì¢…ë¥˜ (ì±…/ë…¸ë˜)
    author,	// ì‘ê°€ ì´ë¦„
    body,	// ë‚´ìš©
    reference,	// ì±… ë˜ëŠ” ë…¸ë˜ ì œëª©
    timestamp,	// ê¸€ë§ˆë”” ìƒì„±ì‹œê°
    uid,	// ìœ ì € id
    likesNum,	// ì¢‹ì•„ìš” ìˆ˜
    tags, 	// íƒœê·¸ ëª©ë¡
  }
},

likes: {
  uid: {
    favoritePosts,	// ìœ ì €ê°€ ì¢‹ì•„ìš” í‘œì‹œí•œ ê¸€ë§ˆë”” id ëª©ë¡
  }
}
```

- Realtime DBì—ê²Œ ë°ì´í„° CRUD(ì½ê¸°, ì“°ê¸°, ìˆ˜ì •, ì‚­ì œ)ë¥¼ ìš”ì²­í•  ë°©ë²•ìœ¼ë¡œ `REST API`ë¥¼ í™œìš©í•˜ì˜€ìŠµë‹ˆë‹¤. ë°ì´í„° ë¡œë“œ ë° ê°€ê³µì„ ë‹´ë‹¹í•˜ëŠ” `model.js`ì—ê²Œ ë°˜ë³µí•˜ì—¬ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ AJAX ìš”ì²­ í•¨ìˆ˜ë¥¼ ì œê³µí•˜ê¸° ìœ„í•´ ì£¼ì–´ì§„ urlê³¼ typeì˜ REST ìš”ì²­ì„ ì „ë‹¬í•˜ê³  ê²°ê³¼ë¥¼ ë¦¬í„´í•˜ëŠ” ë©”ì„œë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

```js
> helpers.js

/**
 * @description ì£¼ì–´ì§„ urlì— ì£¼ì–´ì§„ typeì˜ REST ìš”ì²­ì„ ì „ë‹¬
 * @param { String } url
 * @param { String } type : AJAX ìš”ì²­ íƒ€ì… (GET | POST | PUT | PATCH | DELETE)
 * @param { String | Object} uploadData
 * @returns response data
 */
export const AJAX = async function (url, type, uploadData = undefined) {
  try {
    // uploadDataê°€ json raw stringì´ë©´ ê·¸ëŒ€ë¡œ ì „ë‹¬
    // ê°ì²´ì´ë©´ json stringìœ¼ë¡œ ë³€í™˜ í›„ ì „ë‹¬
    const fetchPro = fetch(url, {
      method: type,
      headers: { "Content-Type": "application/json" },
      body: uploadData
        ? typeof uploadData === "string"
          ? uploadData
          : JSON.stringify(uploadData)
        : null,
    });

    const res = await Promise.race([timeout(TIMEOUT_SEC), fetchPro]);

    if (!res.ok) {
      throw new Error(`AJAX ì˜¤ë¥˜ ë°œìƒ (${res.status})`);
    }

    const data = await res.json();
    return data;
  } catch (err) {
    throw err;
  }
};
```

- `model.js`ëŠ” `postController.js`ë¡œë¶€í„° ê¸€ë§ˆë”” ë¡œë“œ/ì¶”ê°€/ìˆ˜ì •/ì‚­ì œ, ì¢‹ì•„ìš” í‘œì‹œ/ì œê±° ìš”ì²­ì„ ë°›ê³  ê°ê°ì˜ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ Realtime DB `Endpoint`ë¥¼ AJAX ë©”ì„œë“œì— ì „ë‹¬í•˜ë„ë¡ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

  ```js
  > config.js

  export const API_URL_POSTS =
  "https://geulmadi-default-rtdb.firebaseio.com/posts";
  export const API_URL_LIKES =
  "https://geulmadi-default-rtdb.firebaseio.com/likes";
  ```

  |            ìš”ì²­ ë‚´ìš©             |                           ì—”ë“œí¬ì¸íŠ¸                           | method |
  | :------------------------------: | :------------------------------------------------------------: | :----: |
  |         ì „ì²´ ê¸€ë§ˆë”” ë¡œë“œ         |                     {$API_URL_POSTS}.json                      |  GET   |
  |         ë‹¨ì¼ ê¸€ë§ˆë”” ë¡œë“œ         |                {$API_URL_POSTS}/{$postId}.json                 |  GET   |
  |           ê¸€ë§ˆë”” ì¶”ê°€            |              {$API_URL_POSTS}.json?auth={$token}               |  POST  |
  |           ê¸€ë§ˆë”” ìˆ˜ì •            |         {$API_URL_POSTS}/{$postId}.json?auth={$token}          | PATCH  |
  |           ê¸€ë§ˆë”” ì‚­ì œ            |         {$API_URL_POSTS}/{$postId}.json?auth={$token}          | DELETE |
  |           ì¢‹ì•„ìš” ì¶”ê°€            |      {$API_URL_LIKES}/{$uid}/favorites.json?auth={$token}      | PATCH  |
  |           ì¢‹ì•„ìš” ì·¨ì†Œ            | {$API_URL_LIKES}/{$uid}/favorites/{$postId}.json?auth={$token} | DELETE |
  |     ê¸€ë§ˆë”” ì¢‹ì•„ìš” ê°œìˆ˜ ì½ê¸°      |            {$API_URL_POSTS}/{$postId}/likesNum.json            |  GET   |
  |   ê¸€ë§ˆë”” ì¢‹ì•„ìš” ê°œìˆ˜ ì—…ë°ì´íŠ¸    |         {$API_URL_POSTS}/{$postId}.json?auth={$token}          | PATCH  |
  | ìœ ì €ê°€ ì¢‹ì•„ìš”í•œ ê¸€ë§ˆë”” ëª©ë¡ ë¡œë“œ |             {$API_URL_LIKES}/{$uid}/favorites.json             |  GET   |
  |          ë‚´ ê¸€ë§ˆë”” ë¡œë“œ          |    {$API_URL_POSTS}.json?orderBy="{$uid}"&equalTo="{$uid}"     |  GET   |

<br />

#### â‘¢ ì¹´í…Œê³ ë¦¬ ë° ê²€ìƒ‰ ê¸°ëŠ¥ (hashchange ì´ë²¤íŠ¸)

> êµ¬í˜„ê³¼ì • íšŒê³  â¡ï¸
> [[ê¸€ë§ˆë”” í”„ë¡œì íŠ¸] ì¹´í…Œê³ ë¦¬, ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„ íšŒê³ ](https://velog.io/@minsuhan1/%EA%B8%80%EB%A7%88%EB%94%94-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%B9%B4%ED%85%8C%EA%B3%A0%EB%A6%AC-%EA%B2%80%EC%83%89-%EA%B8%B0%EB%8A%A5-%EA%B5%AC%ED%98%84-%ED%9A%8C%EA%B3%A0)

![ì¹´í…Œê³ ë¦¬](https://github.com/minsuhan1/JavaScript_course_2022/assets/50696567/8976edbb-8231-4257-9e21-1fb1b9c73089)

![ê²€ìƒ‰](https://github.com/minsuhan1/JavaScript_course_2022/assets/50696567/4f0dedf7-32e5-42f4-b46f-18e140c8e834)

- ìœ ì €ê°€ ì„ì˜ì˜ ì¹´í…Œê³ ë¦¬ë¥¼ í´ë¦­í•˜ë©´ urlì˜ hash(#) ì •ë³´ê°€ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ idë¡œ ì„¤ì •ë˜ë„ë¡ `href` ê°’ì„ ë³€ê²½í•©ë‹ˆë‹¤. hash ë³€ê²½ì„ `hashchange` ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆê°€ ê°ì§€í•˜ë©´, ì „ì²´ í˜ì´ì§€ë¥¼ reload í•˜ì§€ ì•Šê³  ê¸€ë§ˆë”” ë¦¬ìŠ¤íŠ¸ê°€ í‘œì‹œë  ì»¨í…Œì´ë„ˆì—ë§Œ ì„ íƒí•œ ì¹´í…Œê³ ë¦¬ì˜ ê¸€ë§ˆë””ë¥¼ ë¡œë“œí•˜ë„ë¡ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

- hashchange ì´ë²¤íŠ¸ë¥¼ `postListView.js`ì—ì„œ ê°ì§€í•œ ë‹¤ìŒ, ë°”ë€ hash ê°’ì„ `postController.js`ê°€ ë“±ë¡í•œ handlerì— ì „ë‹¬í•©ë‹ˆë‹¤. `postController.js`ëŠ” `hash`ê°’ì— ë”°ë¼ `model.js`ì—ê²Œ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì— ë§ê²Œ ê¸€ë§ˆë””ë“¤ì„ ê°€ê³µí•´ì„œ ë‹¬ë¼ê³  ìš”ì²­í•œ ë‹¤ìŒ, ê²°ê³¼ë¥¼ ë°›ì•„ `postListView.js`ì˜ render ë©”ì„œë“œì— ì „ë‹¬í•˜ì—¬ ë Œë”ë§ì„ í•˜ê²Œ í•©ë‹ˆë‹¤.

- ê²€ìƒ‰ ê¸°ëŠ¥ ì—­ì‹œ ë¹„ìŠ·í•˜ê²Œ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ìœ ì €ê°€ ê¸€ë§ˆë”” ë³¸ë¬¸, ì œëª©, ì‘ê°€, íƒœê·¸ ì¤‘ ì„ íƒí•œ ê²€ìƒ‰ ê¸°ì¤€ê³¼, í‚¤ì›Œë“œë¥¼ ê°€ì§€ê³  ì£¼ì†Œì˜ hash ê°’ì„ `#search?type={$ê¸°ì¤€}&key={$í‚¤ì›Œë“œ}`ë¡œ ë³€ê²½í•˜ë©´, `postController.js`ê°€ hashê°’ì—ì„œ ê²€ìƒ‰ê¸°ì¤€ê³¼ í‚¤ì›Œë“œë¥¼ ì¶”ì¶œí•˜ì—¬ `model.js`ì˜ `loadSearchResults` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ì¡°ê±´ì— ë§ëŠ” ê¸€ë§ˆë””ë¥¼ ê²€ìƒ‰í•´ë‹¬ë¼ê³  ìš”ì²­í•©ë‹ˆë‹¤.

```js
> postListView.js

addHandlerFilter(handler) {
  ['hashchange'].forEach(ev =>
    window.addEventListener(ev, () => {
      handler(location.hash);
    })
  );
}
```

```js
> postController.js

/**
 * @description ê¸€ë§ˆë”” ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ì„œ ë Œë”ë§
 * @param { string } hash ì£¼ì†Œì°½ hashê°’
 */
export const controlLoadPosts = async function (hash) {
  try {
    // ...
    let promise_load, data;
    if ((hash === "#recent") | !hash) {
      promise_load = model.loadPost("recent");
    }
    if (hash === "#trending") {
      promise_load = model.loadPost("trending");
    }
    if (hash === "#my") {
      promise_load = model.loadPost("my", uid);
    }
    if (hash === "#likes") {
      promise_load = model.loadPost("likes", uid, userFavorites);
    }
    if (hash.startsWith("#search")) {
      const query = decodeURI(hash); // ì£¼ì†Œ í•œê¸€ ë””ì½”ë”©
      const type = query.slice(13, query.indexOf("&")); // ê²€ìƒ‰ ê¸°ì¤€
      const keyword = query.slice(query.lastIndexOf("=") + 1); // í‚¤ì›Œë“œ

      promise_load = model.loadSearchResults(type, keyword);
    }

    // ... í”„ë¡œë¯¸ìŠ¤ ì‹¤í–‰ => ê²°ê³¼ ìˆ˜ì§‘ í›„ ë Œë”ë§

  } catch (err) {
    // ...
  }
};

export const controlFilter = async function (hash) {
  await controlLoadPosts(hash);
};

postListView.addHandlerFilter(controlFilter);
```

<br />

#### â‘£ ê¸€ë§ˆë”” ì¹´ë“œ PNG ë‹¤ìš´ë¡œë“œ ë° ê³µìœ  (html-to-image, blob, downloadjs, Web Share API)

> êµ¬í˜„ê³¼ì • íšŒê³  â¡ï¸
> [[ê¸€ë§ˆë”” í”„ë¡œì íŠ¸] ê¸€ë§ˆë”” ì¹´ë“œ PNG ë‹¤ìš´ë¡œë“œ ë° ê³µìœ  ê¸°ëŠ¥ êµ¬í˜„ íšŒê³ ](https://velog.io/@minsuhan1/%EA%B8%80%EB%A7%88%EB%94%94-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EA%B8%80%EB%A7%88%EB%94%94-%EC%B9%B4%EB%93%9C-PNG-%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C-%EB%B0%8F-%EA%B3%B5%EC%9C%A0-%EA%B8%B0%EB%8A%A5-%EA%B5%AC%ED%98%84-%ED%9A%8C%EA%B3%A0)

![Animation](https://github.com/minsuhan1/JavaScript_course_2022/assets/50696567/8e520f84-83f9-41dc-b4a8-7a170e813e85)

- ìœ ì €ê°€ ê¸€ë§ˆë”” ì¹´ë“œë¥¼ PNG ì´ë¯¸ì§€ íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ê¸°ëŠ¥ê³¼, ì™¸ë¶€ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ PNG ì´ë¯¸ì§€ íŒŒì¼ì„ ê³µìœ í•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

- ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ â¡ï¸ `html-to-image` ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ `toPng` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ DOM ìš”ì†Œë¥¼ PNG ì´ë¯¸ì§€ ë°ì´í„°ë¡œ ë³€í™˜í•œ ë‹¤ìŒ, ì´ë¯¸ì§€ dataUrlì„ `downloadjs` ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ `download` ë©”ì„œë“œì— ì „ë‹¬í•˜ì—¬ ë””ë°”ì´ìŠ¤ì— PNG ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.

```js
import download from 'downloadjs';
import * as htmlToImage from 'html-to-image';

/* ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ (html-to-image, downloadjs library) */
async #downloadImage() {
  document.querySelector('body').addEventListener('click', e => {
    if (e.target.closest('.download')) {
      // ì¹´ë“œ DOMì„ pngë¡œ ë‹¤ìš´ë¡œë“œ (ì•„ì´ì½˜ ì œì™¸)
      const node = document.querySelector('.card');
      htmlToImage
        .toPng(node, {
          filter: node => node.className !== 'tabs',
        })
        .then(dataUrl => {
          download(dataUrl, 'geulmadi.png');
        })
        .catch(e => {});
    }
  });
}
```

- ì´ë¯¸ì§€ ì™¸ë¶€ ê³µìœ  â¡ï¸ DOM ìš”ì†Œë¥¼ PNG ì´ë¯¸ì§€ dataUrlë¡œ ë³€í™˜í•œ ë‹¤ìŒ `blob` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ blob ê°ì²´ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. blob ê°ì²´ë¥¼ ê°€ì§€ê³  `File` ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ ì‹¤ì œ íŒŒì¼ë¡œ ë³€í™˜í•œ í›„, `Web Share API`ì˜ `navigator.share` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë¸Œë¼ìš°ì €ì—ì„œ í•´ë‹¹ íŒŒì¼ì„ ì™¸ë¶€ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ ê³µìœ í•˜ëŠ” ë„¤ì´í‹°ë¸Œ ë‹¤ì´ì–¼ë¡œê·¸ê°€ í‘œì‹œë˜ë„ë¡ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

```js
async #shareImage() {
  document.querySelector('body').addEventListener('click', e => {
    if (e.target.closest('.share')) {
      // 1. ì¹´ë“œ DOMì„ png dataUrlë¡œ ë³€í™˜
      // 2. dataUrlì„ blob ê°ì²´ë¡œ ë³€í™˜
      // 3. blob ê°ì²´ë¥¼ File ê°ì²´ë¡œ ë³€í™˜
      // 4. navigator.share(fileê°ì²´)ë¡œ ê³µìœ 
      const node = document.querySelector('.card');
      htmlToImage
        .toPng(node, {
        filter: node => node.className !== 'tabs',
      })
        .then(async dataUrl => {
        if (navigator.share) {
          const blob = await (await fetch(dataUrl)).blob();
          const file = new File([blob], 'geulmadi.png', {
            type: 'image/png',
            lastModified: new Date(),
          });
          navigator.share({ files: [file] }).then(() => {});
        }
      })
        .catch(e => {});
    }
  });
}
```

<br />

#### â‘¤ ëª¨ë°”ì¼ ë°˜ì‘í˜• UI êµ¬í˜„

> êµ¬í˜„ê³¼ì • íšŒê³  â¡ï¸
> [[ê¸€ë§ˆë”” í”„ë¡œì íŠ¸] ë°˜ì‘í˜• UI êµ¬í˜„ íšŒê³ ](https://velog.io/@minsuhan1/%EA%B8%80%EB%A7%88%EB%94%94-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EB%B0%98%EC%9D%91%ED%98%95-UI-%EA%B5%AC%ED%98%84-%ED%9A%8C%EA%B3%A0)

![Animation](https://github.com/minsuhan1/JavaScript_course_2022/assets/50696567/997349f8-fb2f-455a-9651-1f7020a093ad)

- `media query`ì™€ `@mixin`ì„ í™œìš©í•˜ì—¬ íƒœë¸”ë¦¿ ë° ëª¨ë°”ì¼ í™˜ê²½ì— ìµœì í™”ëœ ë ˆì´ì•„ì›ƒ ë° ì‚¬ìš©ì UXë¥¼ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.

- ëª¨ë°”ì¼ í™˜ê²½ì—ì„œ ê¸€ë§ˆë”” ëª©ë¡ì´ ê¸¸ì–´ì§ˆìˆ˜ë¡ ìœ ì €ê°€ ë‹¤ë¥¸ ì¹´í…Œê³ ë¦¬ë¥¼ íƒìƒ‰í•˜ê³  ì‹¶ì„ ë•Œ í•œì°¸ì„ ë‹¤ì‹œ ìœ„ë¡œ ìŠ¤í¬ë¡¤í•´ì•¼ í•˜ëŠ” ë¶ˆí¸í•¨ì´ ì—†ë„ë¡, `Intersection Observer API`ë¥¼ í™œìš©í•˜ì—¬ ê¸€ë§ˆë”” ëª©ë¡ì„ ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤í•  ë•Œ ì¹´í…Œê³ ë¦¬ ë‚´ë¹„ê²Œì´ì…˜ ë°” (ìµœì‹ /ì¸ê¸°/ë‚´ ê¸€ë§ˆë””/ì¢‹ì•„ìš”)ê°€ í™”ë©´ ìƒë‹¨ì— ê³ ì •ë˜ë„ë¡ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.

<br />
